{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 11,
  "summary": "Build a PWA web app \"Dart Scoring\" using Next.js + React + TypeScript, with tablet/phone-friendly UI plus core game state/data model and scoring rules logic (ready to wire into the UI).",
  "architectural_notes": [
    "Tech stack: Next.js + React + TypeScript; target is a PWA.",
    "Initial routes/pages required: / (Start Game) and /game (Game Screen).",
    "UI first: simple, clean, optimized for tablet/phone with large buttons and readable player cards.",
    "Include a basic layout with a header displaying the app name (Dart Scoring).",
    "Prepare component structure: PlayerCard, Keypad, TurnHistory; do not implement game logic yet (navigation + UI only).",
    "Persist Start Game settings (mode, double out, players) from `/` to `/game` using localStorage as the simplest/stablest approach.",
    "Add core game state module (UI-agnostic) with Game/Player/Turn types and pure functions: startGame(settings), applyTurn(scoredPoints 0–180), undoLastTurn(); implement bust rules and Double Out special cases incl. needsDoubleConfirmation flag in state.",
    "On `/game`, connect UI to core game state: PlayerCard shows remaining and active highlight from currentPlayerIndex; Keypad has input + digit buttons + Enter + quick-score chips (26,41,45,60,85,100,121,140,180); Enter submits to applyTurn() and updates turn history; Undo triggers undoLastTurn(); history list shows last 5 turns.",
    "Implement game-over flow: if Double Out OFF and remaining==0 -> winner; if Double Out ON and remaining==0 -> ask \"Was it a double finish?\"; YES -> winner, NO -> treat as bust (revert turn). Add Game Over UI with winner + turn count and actions Rematch (same settings) / New Game (back to /)."
  ],
  "known_issues": [],
  "isFixRequest": false,
  "existing_features": [
    {
      "id": "feature-create-two-frontend-routes-pages-start-game-and-game-game-screen-with-working-navigation-between-them-e-g-a-primary-cta-on-that-navigates-to-game-and-a-back-affordance-on-game-that-returns-to",
      "title": "Create two frontend routes/pages: `/` (Start Game) and `/game` (Game Screen), with working navigation between them (e.g., a primary CTA on `/` that navigates to `/game`, and a back affordance on `/game` that returns to `/`).",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-a-shared-app-layout-used-by-both-pages-including-a-header-bar-that-displays-the-app-name-dart-scoring-and-provides-consistent-spacing-padding-suitable-for-tablet-phone-screens",
      "title": "Implement a shared app layout used by both pages, including a header bar that displays the app name \"Dart Scoring\" and provides consistent spacing/padding suitable for tablet/phone screens.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-create-the-requested-ui-component-structure-and-placeholder-implementations-ui-only-no-scoring-rules-playercard-keypad-and-turnhistory-organized-in-a-clear-reusable-folder-structure-under-the-frontend-source-tree",
      "title": "Create the requested UI component structure and placeholder implementations (UI only, no scoring rules): `PlayerCard`, `Keypad`, and `TurnHistory`, organized in a clear, reusable folder structure under the frontend source tree.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    },
    {
      "id": "feature-design-a-simple-clean-tablet-phone-first-ui-style-and-apply-it-consistently-across-the-app-colors-typography-spacing-button-sizing-card-styling-keep-controls-large-and-touch-friendly-and-player-cards-highly-legible-use-english-for-all-visible-ui-text",
      "title": "Design a simple, clean, tablet/phone-first UI style and apply it consistently across the app (colors, typography, spacing, button sizing, card styling). Keep controls large and touch-friendly and player cards highly legible. Use English for all visible UI text.",
      "reqIds": [
        "REQ-4"
      ],
      "version": 1
    },
    {
      "id": "feature-add-basic-pwa-scaffolding-so-the-app-can-be-installed-include-a-web-app-manifest-name-short-name-display-mode-theme-background-colors-and-reference-it-from-the-frontend-entry-html-ensure-required-app-icons-are-included-as-static-assets",
      "title": "Add basic PWA scaffolding so the app can be installed: include a web app manifest (name, short_name, display mode, theme/background colors) and reference it from the frontend entry HTML; ensure required app icons are included as static assets.",
      "reqIds": [
        "REQ-5"
      ],
      "version": 1
    },
    {
      "id": "feature-add-the-generated-pwa-icon-assets-to-frontend-public-assets-generated-and-wire-them-into-the-manifest-so-they-are-served-statically-do-not-route-images-through-the-backend",
      "title": "Add the generated PWA icon assets to `frontend/public/assets/generated` and wire them into the manifest so they are served statically (do not route images through the backend).",
      "reqIds": [
        "REQ-6"
      ],
      "version": 1
    },
    {
      "id": "feature-replace-the-current-startgamepage-marketing-placeholder-content-with-a-start-game-configuration-form-that-includes-1-game-mode-selection-with-a-radio-group-for-301-vs-501-2-a-double-out-on-off-switch-3-a-player-list-editor-supporting-1-4-players-with-an-add-player-button-per-player-name-input-and-a-remove-button-that-is-disabled-hidden-when-only-1-player-remains-keep-the-ui-touch-friendly-and-consistent-with-the-existing-tailwind-styling",
      "title": "Replace the current `/` (StartGamePage) marketing/placeholder content with a Start Game configuration form that includes: (1) game mode selection with a radio group for 301 vs 501, (2) a 'Double Out' on/off switch, (3) a player list editor supporting 1–4 players with an 'Add player' button, per-player name input, and a remove button that is disabled/hidden when only 1 player remains; keep the UI touch-friendly and consistent with the existing Tailwind styling.",
      "reqIds": [
        "REQ-7"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-stable-settings-handoff-from-to-game-by-persisting-the-selected-mode-double-out-flag-and-player-names-to-localstorage-when-start-game-is-pressed-then-navigate-to-game-on-save-validate-sanitize-player-names-so-there-are-no-empty-names-by-auto-filling-defaults-like-player-1-player-2-etc-based-on-the-player-index-for-any-blank-whitespace-only-inputs",
      "title": "Implement stable settings handoff from `/` to `/game` by persisting the selected mode, double-out flag, and player names to `localStorage` when 'Start Game' is pressed, then navigate to `/game`. On save, validate/sanitize player names so there are no empty names by auto-filling defaults like 'Player 1', 'Player 2', etc. (based on the player index) for any blank/whitespace-only inputs.",
      "reqIds": [
        "REQ-8"
      ],
      "version": 1
    },
    {
      "id": "feature-update-game-gamepage-to-initialize-its-displayed-player-list-and-starting-scores-from-the-saved-localstorage-settings-created-on-if-no-saved-settings-exist-e-g-user-visits-game-directly-fall-back-to-sensible-defaults-mode-501-double-out-off-two-players-named-player-1-and-player-2-without-crashing",
      "title": "Update `/game` (GamePage) to initialize its displayed player list and starting scores from the saved localStorage settings created on `/`. If no saved settings exist (e.g., user visits `/game` directly), fall back to sensible defaults (mode 501, Double Out off, two players named 'Player 1' and 'Player 2') without crashing.",
      "reqIds": [
        "REQ-9"
      ],
      "version": 1
    },
    {
      "id": "feature-create-a-frontend-game-core-module-that-defines-the-core-data-model-and-state-for-a-darts-scoring-game-including-typescript-types-for-game-player-and-turn-designed-to-be-easy-to-connect-to-the-existing-ui",
      "title": "Create a frontend game-core module that defines the core data model and state for a darts scoring game, including TypeScript types for Game, Player, and Turn, designed to be easy to connect to the existing UI.",
      "reqIds": [
        "REQ-10"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-startgame-settings-to-initialize-a-new-game-state-from-the-saved-settings-mode-301-501-doubleout-flag-player-names-setting-each-player-s-remaining-score-to-the-starting-mode-currentplayerindex-to-the-first-player-and-an-empty-turn-history",
      "title": "Implement startGame(settings) to initialize a new Game state from the saved settings (mode 301/501, doubleOut flag, player names), setting each player's remaining score to the starting mode, currentPlayerIndex to the first player, and an empty turn history.",
      "reqIds": [
        "REQ-11"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-applyturn-scoredpoints-to-update-the-game-state-for-the-current-player-according-to-the-scoring-rules-0-180-validation-bust-handling-double-out-rules-append-an-entry-to-the-turn-history-and-advance-currentplayerindex-when-appropriate",
      "title": "Implement applyTurn(scoredPoints) to update the Game state for the current player according to the scoring rules (0–180 validation, bust handling, Double Out rules), append an entry to the turn history, and advance currentPlayerIndex when appropriate.",
      "reqIds": [
        "REQ-12"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-undolastturn-to-revert-the-game-state-to-exactly-what-it-was-before-the-most-recent-recorded-turn-restoring-per-player-remaining-scores-currentplayerindex-and-any-related-flags-including-needsdoubleconfirmation",
      "title": "Implement undoLastTurn() to revert the Game state to exactly what it was before the most recent recorded turn, restoring per-player remaining scores, currentPlayerIndex, and any related flags (including needsDoubleConfirmation).",
      "reqIds": [
        "REQ-13"
      ],
      "version": 1
    },
    {
      "id": "feature-wire-the-new-core-game-state-into-the-existing-game-screen-in-a-minimal-non-flashy-way-so-it-is-ready-for-ui-usage-initialize-the-game-state-via-startgame-loadgamesettings-show-remaining-values-in-playercard-drive-the-active-player-highlight-from-currentplayerindex-and-replace-mock-turn-data-with-real-turn-history",
      "title": "Wire the new core game state into the existing /game screen in a minimal, non-flashy way so it is ready for UI usage: initialize the Game state via startGame(loadGameSettings()), show remaining values in PlayerCard, drive the active player highlight from currentPlayerIndex, and replace mock turn data with real turn history.",
      "reqIds": [
        "REQ-14"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-keypad-flow-to-support-entering-a-scoredpoints-value-and-submitting-it-to-applyturn-scoredpoints-and-clearing-input-while-keeping-the-ui-touch-friendly-and-without-adding-new-visual-complexity",
      "title": "Update the keypad flow to support entering a scoredPoints value and submitting it to applyTurn(scoredPoints), and clearing input, while keeping the UI touch-friendly and without adding new visual complexity.",
      "reqIds": [
        "REQ-15"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-game-score-entry-keypad-ui-to-include-quick-score-chips-for-the-following-values-26-41-45-60-85-100-121-140-180-tapping-a-chip-must-set-the-current-score-input-to-that-chip-value-replacing-any-existing-input-and-keep-the-value-capped-at-180",
      "title": "Update the /game score entry keypad UI to include quick score chips for the following values: 26, 41, 45, 60, 85, 100, 121, 140, 180. Tapping a chip must set the current score input to that chip value (replacing any existing input) and keep the value capped at 180.",
      "reqIds": [
        "REQ-16"
      ],
      "version": 1
    },
    {
      "id": "feature-rename-the-keypad-submit-action-to-use-the-user-facing-label-enter-and-ensure-the-enter-action-submits-the-current-input-as-scored-points-by-calling-applyturn-game-scoredpoints-on-successful-submit-it-must-clear-the-input-append-a-new-entry-to-turn-history-and-advance-the-current-player-highlight-according-to-the-updated-game-state-on-failure-show-an-english-error-message",
      "title": "Rename the keypad submit action to use the user-facing label \"Enter\" and ensure the Enter action submits the current input as scored points by calling applyTurn(game, scoredPoints). On successful submit, it must clear the input, append a new entry to turn history, and advance the current player highlight according to the updated game state; on failure, show an English error message.",
      "reqIds": [
        "REQ-17"
      ],
      "version": 1
    },
    {
      "id": "feature-change-the-turn-history-display-on-game-to-show-only-the-last-5-turns-most-recent-5-while-preserving-the-existing-table-layout-and-empty-state-messaging",
      "title": "Change the turn history display on /game to show only the last 5 turns (most recent 5) while preserving the existing table layout and empty-state messaging.",
      "reqIds": [
        "REQ-18"
      ],
      "version": 1
    },
    {
      "id": "feature-update-the-game-core-rules-to-support-finishing-a-leg-and-producing-a-game-over-state-rules-to-implement-if-double-out-is-off-and-a-turn-results-in-remaining-0-immediately-end-the-game-and-record-the-winner-if-double-out-is-on-and-a-turn-results-in-remaining-0-do-not-immediately-end-the-game-instead-mark-the-game-as-awaiting-double-finish-confirmation-so-the-ui-can-prompt-the-user-if-double-out-is-on-and-remaining-would-become-1-continue-treating-it-as-a-bust-the-game-core-state-must-expose-enough-information-for-the-ui-to-know-when-the-game-is-awaiting-double-confirmation-know-when-the-game-is-over-identify-the-winner-player-index-name-display-the-number-of-turns-taken-to-win",
      "title": "Update the game-core rules to support finishing a leg and producing a Game Over state.\n\nRules to implement:\n- If Double Out is OFF and a turn results in remaining == 0, immediately end the game and record the winner.\n- If Double Out is ON and a turn results in remaining == 0, do not immediately end the game; instead mark the game as awaiting double-finish confirmation so the UI can prompt the user.\n- If Double Out is ON and remaining would become 1, continue treating it as a bust.\n\nThe game-core state must expose enough information for the UI to:\n- Know when the game is awaiting double confirmation\n- Know when the game is over\n- Identify the winner (player index/name)\n- Display the number of turns taken to win",
      "reqIds": [
        "REQ-19"
      ],
      "version": 1
    },
    {
      "id": "feature-implement-the-double-out-confirmation-prompt-in-the-game-ui-when-double-out-is-on-and-the-game-enters-the-awaiting-double-finish-confirmation-state-immediately-show-a-modal-prompt-with-the-exact-text-was-it-a-double-finish-the-prompt-must-provide-two-actions-yes-confirm-the-double-finish-and-complete-the-win-transition-to-game-over-no-treat-the-last-scoring-attempt-like-a-bust-by-reverting-the-effect-of-that-turn-restore-the-player-s-remaining-score-to-what-it-was-before-the-turn-and-continue-the-game-normally-while-awaiting-confirmation-prevent-further-score-entry-from-being-applied-until-the-user-chooses-yes-or-no",
      "title": "Implement the Double Out confirmation prompt in the /game UI.\n\nWhen Double Out is ON and the game enters the awaiting double-finish confirmation state, immediately show a modal/prompt with the exact text:\n\"Was it a double finish?\"\n\nThe prompt must provide two actions:\n- YES: confirm the double finish and complete the win (transition to Game Over)\n- NO: treat the last scoring attempt like a bust by reverting the effect of that turn (restore the player’s remaining score to what it was before the turn) and continue the game normally\n\nWhile awaiting confirmation, prevent further score entry from being applied until the user chooses YES or NO.",
      "reqIds": [
        "REQ-20"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-game-over-screen-in-the-frontend-that-appears-when-the-game-reaches-a-completed-win-state-the-game-over-screen-must-display-the-winner-player-name-the-number-of-turns-taken-the-game-over-screen-must-include-two-buttons-rematch-start-a-new-game-using-the-same-settings-as-the-finished-game-new-game-navigate-back-to-the-start-game-page-at-user-facing-text-on-this-screen-must-be-in-english",
      "title": "Add a Game Over screen in the frontend that appears when the game reaches a completed win state.\n\nThe Game Over screen must display:\n- The winner (player name)\n- The number of turns taken\n\nThe Game Over screen must include two buttons:\n- \"Rematch\" (start a new game using the same settings as the finished game)\n- \"New Game\" (navigate back to the Start Game page at /)\n\nUser-facing text on this screen must be in English.",
      "reqIds": [
        "REQ-21"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [
    {
      "id": "AR-1",
      "summary": "Set up Next.js + React + TypeScript PWA project foundation for \"Dart Scoring\"",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-2",
      "summary": "Implement routing/pages: / (Start Game) and /game (Game Screen)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-3",
      "summary": "Create basic responsive UI layout with header showing app name",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-4",
      "summary": "Create UI components and folder structure: PlayerCard, Keypad, TurnHistory (UI only, no game logic)",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-5",
      "summary": "Implement `/` (Start Game) UI: 301/501 mode radio, Double Out switch, 1–4 players list with add/remove + name inputs, and Start Game navigation to `/game` passing settings (prefer localStorage) with auto-default player names if blank",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-6",
      "summary": "Implement core game data model + state management (Game/Player/Turn types; state: currentPlayerIndex, remaining per player, turn history) with functions startGame(settings), applyTurn(scoredPoints), undoLastTurn() and rules for bust + Double Out needsDoubleConfirmation flag",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-7",
      "summary": "Wire `/game` UI to game state: show player cards with remaining, highlight current player, implement keypad (input + digit buttons + Enter + quick chips 26/41/45/60/85/100/121/140/180), on Enter call applyTurn() and append history + advance player, add Undo to undoLastTurn(), and display last 5 turns",
      "reqIds": [],
      "status": "pending"
    },
    {
      "id": "AR-8",
      "summary": "Add end-of-leg/win handling: when remaining reaches 0 declare Game Over; if Double Out is ON and remaining reaches 0 prompt \"Was it a double finish?\" (YES ends game, NO treats as bust/undo turn). Provide Game Over screen showing winner + number of turns, with actions Rematch (same settings) and New Game (back to Start).",
      "reqIds": [],
      "status": "pending"
    }
  ],
  "gameProjectType": "none",
  "projectName": "Dart Scoring",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}