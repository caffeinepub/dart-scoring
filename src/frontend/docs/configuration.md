# Configuration Guide

This document describes all configuration values used by the Dart Scoring application, where they are set, and their default values.

## Overview

The Dart Scoring application is designed to run on the Internet Computer (IC) platform with **zero external dependencies**. No Docker, Postgres, or external databases are required. All configuration is managed through:

- **Frontend:** Vite build-time environment variables
- **Backend:** Canister initialization arguments and stable memory
- **Infrastructure:** dfx.json canister settings

## Frontend Configuration

### Build-Time Configuration

The frontend uses Vite's environment variable system for build-time configuration. These values are embedded into the built application.

#### Canister Connection

**Location:** `frontend/src/config.ts` (auto-generated by dfx)

The frontend automatically resolves backend canister connection details through the `createActorWithConfig` function, which:

1. Reads canister IDs from `canister_ids.json` (generated by dfx)
2. Determines the appropriate IC host:
   - **Local development:** `http://127.0.0.1:4943`
   - **Production (IC mainnet):** `https://ic0.app`
3. Creates an authenticated or anonymous actor based on Internet Identity state

**Configuration Values:**

| Variable | Description | Default | Set By |
|----------|-------------|---------|--------|
| `CANISTER_ID_BACKEND` | Backend canister ID | Auto-generated | dfx |
| `CANISTER_ID_FRONTEND` | Frontend canister ID | Auto-generated | dfx |
| `DFX_NETWORK` | Target network (local/ic) | `local` | dfx |
| `IC_HOST` | IC replica/boundary node URL | `http://127.0.0.1:4943` (local)<br>`https://ic0.app` (mainnet) | dfx |

**How to Override (Advanced):**

For custom IC hosts or testing, you can modify the `createActorWithConfig` function in `frontend/src/config.ts` after generation.

## Game Snapshot Contract

For multi-device rendering and realtime synchronization, the application uses a canonical **Game Snapshot** contract. See [Game Snapshot Contract](./game-snapshot-contract.md) for the complete specification.

**Key Points:**

- Backend methods return snapshots with top-level keys: `game`, `players`, `last_turns`, `shot_events_last`
- Realtime events deliver `{ type: "GAME_SNAPSHOT", payload: <snapshot> }` using the same contract
- Frontend UI renders from snapshots without additional requests

## Backend Configuration

The backend canister is a single-actor Motoko service with no external dependencies. All state is stored in stable memory.

### Google OAuth Configuration

**⚠️ Note:** This configuration adds Google OAuth plumbing but **does not change existing authentication settings or flows**. Internet Identity authentication remains the primary authentication method.

The backend stores Google OAuth configuration values that can be queried by the frontend for OAuth flow initialization. These values are configured in the backend canister's stable state.

#### Configuration Keys

| Key | Description | Dev Default | Production |
|-----|-------------|-------------|------------|
| `GOOGLE_CLIENT_ID` | Google OAuth 2.0 Client ID | `default-client-id` | Set via Google Cloud Console |
| `GOOGLE_CLIENT_SECRET` | Google OAuth 2.0 Client Secret (backend only) | `default-client-secret` | Set via Google Cloud Console |
| `GOOGLE_REDIRECT_URI` | Backend OAuth callback endpoint | `http://localhost:8080/google/oauth-callback` | `https://yourdomain.com/google/oauth-callback` |
| `FRONTEND_OAUTH_REDIRECT` | Frontend redirect after OAuth flow | `http://localhost:8080/google/oauth-redirect` | `https://yourdomain.com/google/oauth-redirect` |

#### Security Notes

- **GOOGLE_CLIENT_SECRET** is stored in the backend and **never exposed** via query methods
- Only `GOOGLE_CLIENT_ID`, `GOOGLE_REDIRECT_URI`, and `FRONTEND_OAUTH_REDIRECT` are returned by the `getGoogleOAuthConfig()` query method
- The client secret is used exclusively for backend-to-Google token exchange

#### Development Defaults

For local development, the backend initializes with sensible non-empty defaults that allow the application to run without configuration:

