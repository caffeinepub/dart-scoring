{
  "kind": "build_request",
  "title": "Fix same-origin /api routes returning Not Found by adding minimal route handlers",
  "priority": "high",
  "requirements": [
    {
      "id": "REQ-203",
      "text": "Implement same-origin API route handler for `GET /api/health` so it returns HTTP 200 with JSON body exactly `{ \"ok\": true }` (no Not Found). Prefer implementing via Next.js App Router route handler at `app/api/health/route.ts` if the project uses the `/app` directory. If the project uses the Pages Router instead, implement the equivalent handler at `pages/api/health.ts`.",
      "target": "unknown",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "Utwórz plik:\n   app/api/health/route.ts\n   który zwraca JSON 200:\n   { \"ok\": true }",
          "Po wdrożeniu MUSI działać:\n   - GET /api/health => 200 JSON {ok:true}",
          "Nie zmieniaj UI. Najpierw spraw, żeby /api/health działało."
        ]
      },
      "acceptanceCriteria": [
        "Deploying the app makes `GET /api/health` respond with HTTP 200.",
        "The response `Content-Type` is JSON, and the body is exactly `{ \"ok\": true }` (key name and boolean value).",
        "`GET /api/health` is not a 404/Not Found under any environment (dev/prod)."
      ]
    },
    {
      "id": "REQ-204",
      "text": "Implement same-origin API route handler for `GET /api/auth/google/start` so it is not Not Found and responds with an HTTP redirect (302 is acceptable) to a placeholder URL for now. Prefer implementing via Next.js App Router route handler at `app/api/auth/google/start/route.ts` if the project uses the `/app` directory. If the project uses the Pages Router instead, implement the equivalent handler at `pages/api/auth/google/start.ts`.",
      "target": "unknown",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "Utwórz plik:\n   app/api/auth/google/start/route.ts\n   który na razie zwraca 302 redirect do placeholdera (może być Google URL później),\n   ale NIE może być Not Found.",
          "Po wdrożeniu MUSI działać:\n   - GET /api/auth/google/start => nie Not Found (może redirect)"
        ]
      },
      "acceptanceCriteria": [
        "Deploying the app makes `GET /api/auth/google/start` respond with HTTP 302 (or another 3xx redirect) and a `Location` header.",
        "`GET /api/auth/google/start` is not a 404/Not Found.",
        "The route works under same-origin calls used by the existing frontend (`window.location.href = \"/api/auth/google/start\"`)."
      ]
    },
    {
      "id": "REQ-205",
      "text": "Implement same-origin API route handler for `GET /api/auth/google/callback` so it returns HTTP 200 with JSON indicating the callback was reached. Prefer implementing via Next.js App Router route handler at `app/api/auth/google/callback/route.ts` if the project uses the `/app` directory. If the project uses the Pages Router instead, implement the equivalent handler at `pages/api/auth/google/callback.ts`.",
      "target": "unknown",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "Utwórz plik:\n   app/api/auth/google/callback/route.ts\n   który zwraca JSON 200 z informacją \"callback reached\".",
          "Po wdrożeniu MUSI działać:\n   - GET /api/auth/google/callback => 200"
        ]
      },
      "acceptanceCriteria": [
        "Deploying the app makes `GET /api/auth/google/callback` respond with HTTP 200.",
        "Response is JSON and includes an English message indicating the callback was reached (must include the phrase \"callback reached\").",
        "`GET /api/auth/google/callback` is not a 404/Not Found."
      ]
    },
    {
      "id": "REQ-206",
      "text": "Verify the project routing mode and place the API handlers accordingly: confirm whether the project is using Next.js App Router (`/app`) or Pages Router (`/pages`), and ensure exactly one correct set of handlers is present and used by the runtime so `/api/*` endpoints are reachable after deployment.",
      "target": "unknown",
      "source": {
        "messageIds": [
          "msg-6"
        ],
        "quotes": [
          "Upewnij się, że projekt faktycznie używa folderu /app (App Router).\n   Jeśli projekt używa /pages router zamiast /app:\n   wtedy zrób odpowiedniki: ..."
        ]
      },
      "acceptanceCriteria": [
        "After deployment, the three endpoints `/api/health`, `/api/auth/google/start`, `/api/auth/google/callback` resolve to implemented handlers (no Not Found).",
        "No duplicate/conflicting handler implementations cause ambiguity (only the router appropriate to the project structure is used at runtime)."
      ]
    }
  ],
  "constraints": [
    "Do not change any UI/UX or frontend pages/components; only fix the server-side `/api/*` routing so it no longer returns Not Found.",
    "Use English for any user-facing text returned by the API handlers (e.g., the callback JSON message).",
    "Focus first on making `/api/health` work; ensure it is implemented and verified before relying on the Google routes."
  ],
  "nonGoals": [
    "Implementing the real Google OAuth flow (state handling, token exchange, user mapping) is out of scope for this fix; redirects can go to a placeholder URL.",
    "Changing existing frontend Google sign-in behavior is out of scope; it should keep working against `/api/auth/google/start` once the endpoint exists.",
    "Adding new UI diagnostics or modifying the existing Backend Debug Panel is out of scope."
  ],
  "imageRequirements": {
    "required": [],
    "edits": []
  }
}